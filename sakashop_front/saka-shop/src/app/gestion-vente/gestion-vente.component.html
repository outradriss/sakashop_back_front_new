<div class="gestion-vente-container">
  <!-- Menu lat√©ral -->
  <div class="sidebar">
    <ul>
      <li (click)="navigateToBest('meilleur-vente')">Meilleure Vente</li>
      <li (click)="navigateToBest('statistique')">Statistique</li>
      <li (click)="navigateToBest('gestion-vente')">Gestion de Vente</li>
    </ul>
  </div>

  <!-- Contenu dynamique -->
  <div class="main-content">
    <!-- Affichage de la gestion de vente -->
    <div *ngIf="currentView === 'gestion-vente'">
      <div class="header">
        <h1>Gestion de Vente</h1>
      </div>

      <!-- S√©lection de la p√©riode -->
      <div class="date-range-container">
        <form [formGroup]="dateRangeForm">
          <mat-form-field appearance="outline" class="date-range-field">
            <mat-label>S√©lectionner une p√©riode</mat-label>
            <mat-date-range-input [rangePicker]="picker">
              <input matStartDate formControlName="start" placeholder="Date de d√©but" />
              <input matEndDate formControlName="end" placeholder="Date de fin" />
            </mat-date-range-input>
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-date-range-picker #picker></mat-date-range-picker>
          </mat-form-field>
        </form>
        <div class="date-range-actions">
          <button mat-raised-button color="primary" (click)="applyDateFilter()">Appliquer</button>
          <button mat-raised-button color="warn" (click)="resetDateFilter()">R√©initialiser</button>
        </div>
        <button (click)="exportToCSV()" class="btn-export-csv">Exporter en CSV</button>
      </div>

      <div class="table-container">
        <div class="table-body-scroll">
          <table class="sales-table">
            <thead>
              <tr>
                <th>R√©f√©rence</th>
                <th>Produit</th>
                <th>Quantit√©</th>
                <th>Prix Vente TTC</th>
                <th>Prix Total TTC</th>
                <th>Type de Paiement</th>
                <th>Date de Commande</th>
              </tr>
            </thead>
            <tbody>
              <ng-container *ngFor="let sale of filteredSales">
                <tr *ngFor="let item of sale.items">
                  <td>{{ item.code }}</td>
                  <td>{{ item.nameProduct }}</td>
                  <td>{{ item.quantity }}</td>
                  <td>{{ item.salesPrice | currency: 'MAD' }}</td>
                  <td>{{ item.totalePrice | currency: 'MAD' }}</td>
                  <td>{{ sale.typePaiement }}</td>
                  <td>{{ sale.dateOrder | date:'dd/MM/yyyy HH:mm' }}</td>
                </tr>
              </ng-container>
            </tbody>
          </table>
        </div>
      </div>

      <div class="totals-bar">
        <div class="total-item">
          <span>Total Produits :</span>
          <span>{{ totalProducts }}</span>
        </div>
        <div class="total-item">
          <span>Total quantit√© :</span>
          <span>{{ totalQuantity }}</span>
        </div>
        <div class="total-item">
          <span>Total Prix de Vente :</span>
          <span>{{ totalSellPrice | currency: 'MAD ':'symbol':'1.2-2' }}</span>
        </div>
      </div>
    </div>
    <!-- ‚úÖ Boutons de navigation (style dashboard) -->
   
    <!-- Meilleure Vente -->
<div *ngIf="currentView === 'meilleur-vente'" class="meilleure-vente-container">
  <!-- En-t√™te -->
  <div class="header">
    <h1>üìä Meilleure Vente</h1>
    <button class="btn-back" (click)="navigateToBest('gestion-vente')">‚¨ÖÔ∏è Retour</button>
  </div>

  <!-- Statistiques Globales -->
  <div class="stats-cards">
    <div class="stat-card">
      <h3>üèÜ Produit le plus vendu (7 jours)</h3>
      <p>{{ topSellingProductWeek.name }}</p>
      <p>Quantit√© : {{ topSellingProductWeek.quantity }}</p>
    </div>
    <div class="stat-card">
      <h3>üèÜ Produit le plus vendu (1 mois)</h3>
      <p>{{ topSellingProductMonth.name }}</p>
      <p>Quantit√© : {{ topSellingProductMonth.quantity }}</p>
    </div>
    <div class="stat-card">
      <h3>üèÜ Produit le plus vendu (3 mois)</h3>
      <p>{{ topSellingProduct3Months.name }}</p>
      <p>Quantit√© : {{ topSellingProduct3Months.quantity }}</p>
    </div>
    <div class="stat-card">
      <h3>üìâ Produit le moins vendu</h3>
      <p>{{ leastSellingProduct.name }}</p>
      <p>Quantit√© : {{ leastSellingProduct.quantity }}</p>
    </div>
  </div>


  <!-- Tableau des Meilleures Ventes -->
  <div class="table-container">
    <table class="sales-table">
      <thead>
        <tr>
          <th>Produit</th>
          <th>Prix de Vente (MAD)</th>
          <th>Quantit√© Vendue</th>
          <th>Nombre de fois en Promo</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let product of bestSellingProducts">
          <td>{{ product.name }}</td>
          <td>{{ product.salesPrice | currency:'MAD' }}</td>
          <td>{{ product.quantity }}</td>
          <td>{{ product.promoCount }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Actions -->
  <div class="actions">
    <button class="btn-export" (click)="exportToCSV()">üì• Exporter en CSV</button>
  </div>
</div>
<div class="navigation-buttons">
  <button (click)="navigateTo('gestion-product/list')">Gestion de STOCK</button>
  <button (click)="navigateTo('turnover')">Chiffre d'Affaire</button>
  <button (click)="navigateTo('bon-livraison')">G√©stion BL </button>
  <button (click)="navigateTo('gestion-facture')">üßæ Gestion Facturese</button>
  <button (click)="navigateTo('gestion-caisse')"> Gestion des caisses </button>
  <button class="btn-logout" (click)="logout()">Quitter</button>
</div>